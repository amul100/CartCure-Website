<table role="presentation" width="100%" cellspacing="0" cellpadding="0" style="background-color: <?= colors.paperCream ?>;">
  <tr>
    <td align="center" style="padding: 40px 20px;">
      <table role="presentation" width="600" cellspacing="0" cellpadding="0" style="max-width: 600px; background-color: #ffffff; border: 3px solid <?= colors.paperBorder ?>; box-shadow: 4px 4px 0 rgba(0,0,0,0.08);">

        <!-- Header with Logo -->
        <tr>
          <td align="center" style="padding: 30px 40px 20px 40px; border-bottom: 2px solid <?= colors.paperBorder ?>;">
            <img src="https://cartcure.co.nz/CartCure_fullLogo.png" alt="CartCure" width="180" style="display: block; max-width: 180px; height: auto;">
          </td>
        </tr>

        <!-- Main Heading -->
        <tr>
          <td style="padding: 0;">
            <div style="background-color: <?= colors.brandGreen ?>; padding: 25px 40px; text-align: center;">
              <h1 style="margin: 0 0 8px 0; color: #ffffff; font-size: 28px; font-weight: bold; font-family: Georgia, 'Times New Roman', serif;">
                Friendly Payment Reminder
              </h1>
              <p style="margin: 0; color: rgba(255,255,255,0.8); font-size: 13px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                Invoice: <?= invoiceNumber ?>
              </p>
            </div>
          </td>
        </tr>

        <!-- Greeting -->
        <tr>
          <td style="padding: 25px 40px 20px 40px;">
            <p style="margin: 0 0 15px 0; color: <?= colors.inkBlack ?>; font-size: 16px; line-height: 1.7;">
              Hi <?= clientName ?>,
            </p>
            <p style="margin: 0; color: <?= colors.inkBlack ?>; font-size: 16px; line-height: 1.7;">
              This is a friendly reminder that payment for invoice <strong><?= invoiceNumber ?></strong> is due <?!= dueDateText ?>.
            </p>
          </td>
        </tr>

        <!-- Late Fee Warning -->
        <tr>
          <td style="padding: 0 40px 25px 40px;">
            <div style="background-color: <?= colors.alertBg ?>; border: 2px solid <?= colors.alertBorder ?>; padding: 15px;">
              <p style="margin: 0; color: #856404; font-size: 14px; line-height: 1.6;"><strong>Avoid Late Fees:</strong> Per our Terms of Service, late fees of 2% per day apply to overdue invoices. Pay by <?= dueDate ?> to avoid any additional charges.</p>
            </div>
          </td>
        </tr>

        <!-- Invoice Details -->
        <tr>
          <td style="padding: 0 40px 25px 40px;">
            <div style="background-color: <?= colors.paperCream ?>; border: 2px solid <?= colors.paperBorder ?>; padding: 25px;">
              <table role="presentation" width="100%" cellspacing="0" cellpadding="0">
                <tr>
                  <td style="padding: 8px 0; color: <?= colors.inkGray ?>; font-size: 14px;">Invoice Number</td>
                  <td style="padding: 8px 0; color: <?= colors.inkBlack ?>; font-size: 14px; text-align: right; font-weight: bold;"><?= invoiceNumber ?></td>
                </tr>
                <tr>
                  <td style="padding: 8px 0; color: <?= colors.inkGray ?>; font-size: 14px;">Job Reference</td>
                  <td style="padding: 8px 0; color: <?= colors.inkBlack ?>; font-size: 14px; text-align: right;"><?= jobNumber ?></td>
                </tr>
                <tr>
                  <td style="padding: 8px 0; color: <?= colors.inkGray ?>; font-size: 14px;">Due Date</td>
                  <td style="padding: 8px 0; color: <?= colors.inkBlack ?>; font-size: 14px; text-align: right;"><?= dueDate ?></td>
                </tr>
                <tr><td colspan="2" style="padding: 10px 0;"><hr style="border: none; border-top: 1px solid <?= colors.paperBorder ?>;"></td></tr>
                <tr>
                  <td style="padding: 12px 0 8px 0; color: <?= colors.inkBlack ?>; font-size: 16px; font-weight: bold;">Amount Due</td>
                  <td style="padding: 12px 0 8px 0; color: <?= colors.brandGreen ?>; font-size: 18px; font-weight: bold; text-align: right;"><?= displayTotal ?></td>
                </tr>
              </table>
            </div>
          </td>
        </tr>

        <?!= paymentDetailsHtml ?>

        <!-- Closing -->
        <tr>
          <td style="padding: 0 40px 30px 40px;">
            <p style="margin: 0 0 20px 0; color: <?= colors.inkBlack ?>; font-size: 16px; line-height: 1.7;">
              If you have already made payment, please disregard this reminder â€” thank you!
            </p>
            <p style="margin: 0 0 20px 0; color: <?= colors.inkBlack ?>; font-size: 16px; line-height: 1.7;">
              If you have any questions about this invoice, simply reply to this email and we'll be happy to help.
            </p>
            <p style="margin: 0; color: <?= colors.inkBlack ?>; font-size: 16px;">
              Thanks for your business!<br>
              <strong style="color: <?= colors.brandGreen ?>;">The CartCure Team</strong>
            </p>
          </td>
        </tr>

        <!-- Footer -->
        <tr>
          <td style="padding: 25px 40px; background-color: <?= colors.paperCream ?>; border-top: 2px solid <?= colors.paperBorder ?>;">
            <p style="margin: 0; color: <?= colors.inkLight ?>; font-size: 12px; text-align: center; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
              <?= businessName ?> | Quick Shopify Fixes for NZ Businesses<br>
              <?!= gstFooterLine ?>
              <a href="https://cartcure.co.nz" style="color: <?= colors.brandGreen ?>; text-decoration: none;">cartcure.co.nz</a>
            </p>
          </td>
        </tr>

      </table>
    </td>
  </tr>
</table>
